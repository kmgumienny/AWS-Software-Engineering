<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scheduler</title>
</head>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<body>
<h1 style="text-align: center" id="title">Welcome to Scheduler</h1>
<div style="text-align: center">
    <div id="createScheduleDiv">
        <button onclick="window.location.href = './CreateMeetingPage.html'"/>
        Create Schedule</button>
    </div>

    <div  style="text-align: center; margin-top: 5%;">
        <p id="errMessage" style="color: red;">

        </p>


    </div>

    <div style="text-align: center; margin-top: 5%;">
        <form id="scheduleForm" name="scheduleForm" onsubmit="JavaScript:handleGetClick()">
            <label style="margin-bottom: 15px; display: block;">
                If you are a participant, enter ScheduleID you wish to access:
                <input id="scheduleID" type="text" required>
                <br>
            </label>


            <label style="margin-bottom: 15px; display: block;">
                <input id="createButton" type="button" value="Submit" onClick="JavaScript:handleGetClick()">
                <br>
            </label>

        </form>
    </div>

<div id="changeWeekButtons" style="visibility: hidden;">
    <div style="float: left;">
        <input type="button" value="Previous Week" onClick="JavaScript:generateSchedule(js, -1)">
    </div>
    <div style="float: right;">
        <input type="button" value="Next Week" onClick="Javascript:generateSchedule(js, 1)">
    </div>
    <br>
    <br>
</div>
    <div id="calendarDiv"></div>


</div>

<div id="OrganizerButtonToggle" style="text-align: center; display: none; margin-top: 5%;">
    <input type="button" value="If you are the organizer, click here" onclick="JavaScript:toggleOrganizerDiv()">
</div>

<div id="organizerDiv" style="text-align: center; border-width: 2px; border-color: black; margin-top: 20px; display: none;">
<p style="color: salmon;">By having the organizer panel open, participant functions are disabled.</p>

    <div style="display: flex;">
    <div style="width: 33%; margin-left: auto; margin-right: auto;">
    <h3>Delete Schedule</h3>
    <form id="deleteForm" onsubmit="JavaScript:deleteSchedule()">
        <label>
            What is the Secret Key?
            <input id="secretKey" type="text" required/>
        </label>
        <label style="margin-bottom: 15px; display: block;">
            What is the id
            <input id="scheduleIDDelete" type="text" required>
        </label>
        <label style="margin-bottom: 15px; display: block;">
            <input id="deleteMeetingButton" type="button" value="Submit" onClick="JavaScript:deleteSchedule()">
            <br>
        </label>
    </form>
    <P id="deleteErrorMessage" style="color: red;"></P>
    </div>

    <div style="width: 33%; margin-left: auto; margin-right: auto;">
        <h3>Cancel Meeting</h3>
        <form onsubmit="JavaScript:organizerCancelMeeting()">
            <label>
                What is the Schedule Secret Key?
                <input id="cancelMeetingSecretKey" type="text" required/>
            </label>
            <label style="margin-bottom: 15px; display: block;">
                Selected Time Slot has an ID of:
                <input id="organizerCancelMeetingID" type="text" readonly>
            </label>
            <label style="margin-bottom: 15px; display: block;">
                <input id="organizerCancelMeetingButton" type="button" value="Submit" onClick="JavaScript:organizerCancelMeeting()">
                <br>
            </label>
        </form>
        <P id="organizerDeleteErrorMessage" style="color: red;"></P>
        <label id="organizerDeleteReload" style="margin-bottom: 15px; display: none;">
            <input type="button" value="Reload" onClick="JavaScript:handleGetClick()">
            <br>
        </label>
    </div>

<div style="width: 33%; margin-left: auto; margin-right: auto;">
    <h3 id="closeOpenH3">Close/Open TimeSlot</h3>
    <form onsubmit="JavaScript:chooseOpenClose()">
        <label>
            What is the Schedule Secret Key?
            <input id="closeMeetingSecretKey" type="text" required/>
        </label>
        <label style="margin-bottom: 15px; display: block;">
            Selected Time Slot has an ID of:
            <input id="organizerCloseMeetingID" type="text" readonly>
        </label>
        <label style="margin-bottom: 15px; display: block;">
            <input id="organizerCloseMeetingButton" type="button" value="Submit" onClick="JavaScript:chooseOpenClose()">
            <br>
        </label>
    </form>
    <P id="organizerCloseErrorMessage" style="color: red;"></P>
    <label id="organizerCloseReload" style="margin-bottom: 15px; display: none;">
        <input type="button" value="Reload" onClick="JavaScript:handleGetClick()">
        <br>
    </label>

</div>

</div>
</div>


<div id="meetingDiv" style="display: none">
    <h3>For Attendee</h3>
    <form id="meetingForm" name="meetingForm" onsubmit="JavaScript:createMeeting()">
        <label>
            Your selected Timeslot has an ID of:
            <input id="timeslotKeyField" style="" readonly />
        </label>
        <label style="margin-bottom: 15px; display: block;">
            If you are a participant, enter your name below to reserve the timeslot:
            <input id="nameTimeslot" type="text" required>

        </label>

        <label style="margin-bottom: 15px; display: block;">
            <input id="createMeetingButton" type="button" value="Submit" onClick="JavaScript:createMeeting()">
            <br>
        </label>
    </form>
    <P id="scheduleMeetingErrorMessage" style="color: red;"></P>
    <form id="confirmMeetingForm" style="display: none;" onsubmit="JavaScript:handleGetClick()">
        <label>
            Your secret key is:
            <input id="meetingSecretKeyField" style="" readonly />
        </label>
        <p>
            Press 'Reload' to reload once you have copied down your key.
        </p>
        <label style="margin-bottom: 15px; display: block;">
            <input type="button" value="Reload" onClick="JavaScript:handleGetClick()">
            <br>
        </label>
    </form>
</div>

<div id="cancelMeetingDiv" style="display: none">
    <h3>For Attendee</h3>
    <form id="cancelMeetingForm" name="meetingForm" onsubmit="JavaScript:deleteMeeting()">
        <label>
            Your selected Timeslot has an ID of:
            <input id="timeslotKeyField2" style="" readonly />
        </label>
        <label style="margin-bottom: 15px; display: block;">
            This timeslot is reserved by:
            <input id="nameTimeslot2" type="text" readonly>
        </label>

        <label>
            Enter your secret key to continue:
            <input id="meetingSecretKey" type="text" required>
        </label>

        <label style="margin-bottom: 15px; display: block;">
            <input id="cancelMeetingButton" type="button" value="Submit" onClick="JavaScript:deleteMeeting()">
            <br>
        </label>
    </form>
    <P id="cancelScheduleMeetingErrorMessage" style="color: red;"></P>
    <form id="confirmCancelMeetingForm" style="display: none;" onsubmit="JavaScript:handleGetClick()">
        <p>
            Press 'Reload' to reload once you have copied down your key.
        </p>
        <label style="margin-bottom: 15px; display: block;">
            <input type="button" value="Reload" onClick="JavaScript:handleGetClick()">
            <br>
        </label>
    </form>
</div>

<div style="position: fixed; left: 0; bottom: 15px; width: 100%; color: white; text-align: center;">
    <a href="./AdminPanel.html">Enter the Admin Panel by clicking here!</a>
</div>

<script>

    var weekNum;
    var js = {};
    var getURL = 'https://0ssnizv9l4.execute-api.us-east-2.amazonaws.com/alpha/getschedule';
    var deleteURL = 'https://gh13hei2z1.execute-api.us-east-2.amazonaws.com/alpha/deleteschedule';
    var scheduleMeetingURL = 'https://bf8e9h7l2j.execute-api.us-east-2.amazonaws.com/alpha/schedulemeeting'
    var deleteMeetingsURL = 'https://ejsjv6iale.execute-api.us-east-2.amazonaws.com/alpha/deletemeeting';
    var deleteMeetingOrganizerURL = 'https://rfz4c5o1lf.execute-api.us-east-2.amazonaws.com/alpha/deletemeetingbyorginizer';
    var closeMeetingOrganizerURL = 'https://x0o3pw5l8k.execute-api.us-east-2.amazonaws.com/alpha/closesingletimeslot';
    var openMeetingOrganizerURL = 'https://coph493euh.execute-api.us-east-2.amazonaws.com/alpha/opensingletimeslot';
    function handleGetClick(){
        event.preventDefault();
        if(document.getElementById("scheduleID").value == "")
            alert("Please Enter a Valid ScheduleID");
        else{
            var scheduleID = document.getElementById("scheduleID").value;
            document.getElementById("scheduleForm").style.visibility = "hidden";
            document.getElementById("createScheduleDiv").style.visibility = "hidden";
            var getString= {};
            getString["scheduleID"] = scheduleID;
            var js = JSON.stringify(getString);

            var xhr = new XMLHttpRequest();
            xhr.open("POST", getURL, true);

            // send the collected data as JSON
            xhr.send(js);

            // This will process results and update HTML as appropriate.
            xhr.onloadend = function () {
                console.log(xhr);
                console.log(xhr.request);

                if (xhr.readyState == XMLHttpRequest.DONE) {
                    console.log ("XHR:" + xhr.responseText);
                    var jsonResponse = JSON.parse(xhr.responseText);

                    if (jsonResponse.httpCode == 422)
                        noScheduleFound();
                    else if (jsonResponse.httpCode == 200) {
                            js = jsonResponse;
                            weekNum = 0;
                            generateSchedule(jsonResponse, 0);
                        }
                    else
                        alert(jsonResponse.message);
                }
            };
        }
    }

    function generateSchedule(json, weekNumIndicator) {
        document.getElementById('errMessage').style.visibility = 'hidden';
        js = json;
        document.getElementById('title').innerText = 'Welcome to the ' + js.schedule.scheduleName + ' schedule';
        document.getElementById('changeWeekButtons').style.visibility = "visible";
        weekNum += weekNumIndicator;
        var startDate = new Date(js.schedule.startDate.year, parseInt(js.schedule.startDate.month) - 1,js.schedule.startDate.day);
        var endDate = new Date(js.schedule.endDate.year, parseInt(js.schedule.endDate.month) - 1, js.schedule.endDate.day);

        var numDays = (endDate - startDate) / 86400000;

        var startTime = js.schedule.dayStartTime;
        var endTime = js.schedule.dayEndTime;
        var increment = js.schedule.timeSlotDuration;

        var numMeetings = ((endTime - startTime) * 60) / increment;

        var calDiv = document.getElementById("calendarDiv");

        var ourTable = document.createElement("table");
        var ourTableBody = document.createElement("tbody");

        var timeSlotDate = new Date(1776, 6, 4);
        var startWeekDate = new Date(startDate.getTime())
        //Add this to the function call
        startWeekDate = new Date(startWeekDate.getTime() + (604800000)*weekNum);
        if(weekNum != 0) {
            var testFirstDay = startWeekDate.getDay();
            startWeekDate.setDate(startWeekDate.getDate() - testFirstDay+1)
        }
        var testDate = new Date(startWeekDate.getTime());

        var firstOccurance = 5;
        var lastOccurance = 0;
        for (var x = 0; x < js.timeSlots.length; x++) {
            if (js.timeSlots[x].dayInWeek < firstOccurance && js.timeSlots[x].week -1 == weekNum)
                firstOccurance = js.timeSlots[x].dayInWeek;
            if (js.timeSlots[x].dayInWeek > lastOccurance && js.timeSlots[x].week -1 == weekNum)
                lastOccurance = js.timeSlots[x].dayInWeek;
        }


        var shouldAdd = false;
        var shouldBuild = false;
        var shouldDatesBuild = true;


        for (var j = 0; j < numMeetings; j++) {

            var row = document.createElement("tr");

                for (var i = startWeekDate.getDay() - 1; i < 7; i++) {

                    testDate.setDate(startWeekDate.getDate() + i - startWeekDate.getDay() - 1);

                    if (testDate <= endDate) {
                        for (var x = 0; x < js.timeSlots.length; x++) {
                            //get the date of a timeslot
                            timeSlotDate = new Date(js.timeSlots[x].startTime.date.year, parseInt(js.timeSlots[x].startTime.date.month) - 1, js.timeSlots[x].startTime.date.day);

                            if ((timeSlotDate.valueOf() === testDate.valueOf()) && ((js.timeSlots[x].slotNumInDay - 1) == j)) {

                                //Building Dates on top of the table, only runs once
                                if (js.timeSlots[x].slotNumInDay == 1 && j == 0 && shouldDatesBuild) {
                                    shouldDatesBuild = false;
                                    var dateRow = document.createElement("tr");
                                    var builderDate = new Date(testDate.getTime());

                                    //Set empty cell top right corner
                                    var emptyCell = true;


                                    for (var y = 0; y < lastOccurance-firstOccurance + 1; y++) {
                                        builderDate.setDate(testDate.getDate() + y);
                                        if ((builderDate.getTime() <= endDate.getTime()) && builderDate.getDay() < 6) {

                                            //Create empty cell top right corner
                                            if(emptyCell){
                                                emptyCell = false;
                                                var cellDate = document.createElement("td");
                                                dateRow.appendChild(cellDate);
                                            }

                                            var cellDate = document.createElement("td");
                                            var cellDateText = document.createTextNode(builderDate.getMonth() + 1 + '-' + builderDate.getDate() + '-' + builderDate.getFullYear());
                                            cellDate.appendChild(cellDateText);
                                            dateRow.appendChild(cellDate);
                                        }
                                    }
                                    ourTableBody.appendChild(dateRow);
                                }

                                shouldBuild = true;
                                shouldAdd = true;

                                //Create time slots in the beginning of rows
                                if(js.timeSlots[x].startTime.date.year == startWeekDate.getFullYear()
                                    && js.timeSlots[x].startTime.date.month == startWeekDate.getMonth()+1
                                    && js.timeSlots[x].startTime.date.day == startWeekDate.getDate()
                                    && js.timeSlots[x].slotNumInDay == j+1){
                                    var cellTime = document.createElement("td");
                                    if (js.timeSlots[x].startTime.time.minute == 0)
                                        var cellTimeText = document.createTextNode(js.timeSlots[x].startTime.time.hour+  ":00");
                                    else
                                        var cellTimeText = document.createTextNode(js.timeSlots[x].startTime.time.hour+  ":" + js.timeSlots[x].startTime.time.minute);
                                    cellTime.appendChild(cellTimeText);
                                    row.appendChild(cellTime);
                                }

                                var cell = document.createElement("td");
                                //var cellText = document.createTextNode(js.timeSlots[x].startTime.time.minute + " " + js.timeSlots[x].startTime.date.day);
                                var scheduleButton = document.createElement("button");
                                scheduleButton.id = js.timeSlots[x].timeslotID;
                                scheduleButton.name = 'aButton';

                                if (js.timeSlots[x].isReserved == true) {
                                    for(var k = 0; k < js.meetings.length; k++){
                                        if( js.meetings[k].timeslotID == js.timeSlots[x].timeslotID){
                                            scheduleButton.innerText = js.meetings[k].meetingName;
                                            scheduleButton.id = js.meetings[k].meetingID;
                                            cell.style.backgroundColor = 'rgba(59, 65, 255, 0.5)';
                                            break;
                                        }
                                    }
                                } else
                                    if(js.timeSlots[x].isOpen == true) {
                                        scheduleButton.innerText = 'OPEN';
                                        cell.style.backgroundColor = 'rgba(11, 202, 11, 0.43)';
                                    } else
                                        if (js.timeSlots[x].isOpen == false) {
                                            scheduleButton.innerText = 'CLOSED';
                                            scheduleButton.disabled = true;
                                            cell.style.backgroundColor = 'rgba(255, 0, 0, 0.44)';
                                        }

                                scheduleButton.className = "meetingButton";
                                cell.appendChild(scheduleButton);
                                row.appendChild(cell);
                            }
                        }

                    }

                }


            if (shouldAdd)
                ourTableBody.appendChild(row);
            shouldAdd = false;
        }


        if (shouldBuild) {
            ourTable.appendChild(ourTableBody);
            ourTable.setAttribute("border", "2");
            ourTable.setAttribute("width", "100%");
            ourTable.setAttribute("margin-right", "auto");
            ourTable.setAttribute("margin-left", "auto");

            if (calDiv.hasChildNodes())
                calDiv.removeChild(calDiv.firstChild);
            calDiv.appendChild(ourTable);
            attachEventListeners();
            document.getElementById("OrganizerButtonToggle").style.display = "block";

        }else {
            alert("You have reached the limit of the Schedule. No schedule left to be generated.");
            weekNum = weekNum - weekNumIndicator;
        }
        document.getElementById('organizerDiv').style.display = 'none';
        hideDivs();
    }


    function attachEventListeners(){
        var meetingButtons = document.getElementsByClassName('meetingButton');
        for (var x = 0; x < meetingButtons.length; x++) {
            meetingButtons[x].addEventListener('click', function () {
                if(document.getElementById("organizerDiv").style.display == "block"){
                    if (this.innerText == 'OPEN' || this.innerText == 'CLOSED') {
                        if(this.innerText == 'OPEN'){
                            document.getElementById('closeOpenH3').innerText = 'Close Timeslot'
                        }
                        else{
                            document.getElementById('closeOpenH3').innerText = 'Open Timeslot'
                        }

                        document.getElementById('organizerCancelMeetingButton').disabled = true;
                        document.getElementById('organizerCloseMeetingButton').disabled = false;
                        document.getElementById('organizerCloseMeetingID').value = this.id;
                    }
                    else{
                        document.getElementById('organizerCancelMeetingID').value = this.id;
                        document.getElementById('organizerCancelMeetingButton').disabled = false;
                        document.getElementById('organizerCloseMeetingButton').disabled = true;

                    }

                }else if(this.innerText == 'OPEN') {
                    document.getElementById("meetingDiv").style.display = "block";
                    document.getElementById("cancelMeetingDiv").style.display = "none";
                    document.getElementById("timeslotKeyField").value = this.id;
                }else {
                    document.getElementById("meetingDiv").style.display = "none";
                    document.getElementById("cancelMeetingDiv").style.display = "block";
                    document.getElementById("timeslotKeyField2").value = this.id;
                    document.getElementById("nameTimeslot2").value = this.innerText;
                }
            });
        }
    }

    function createMeeting(){
        var timeslotID = document.getElementById('timeslotKeyField').value;
        var meetingName = document.getElementById('nameTimeslot').value;

        var createMeetingData = {
            'timeslotID': timeslotID,
            'meetingName': meetingName
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", scheduleMeetingURL, true);

        var stringified = JSON.stringify(createMeetingData);

        xhr.send(stringified);
        xhr.onloadend = function () {
            console.log(xhr);
            console.log(xhr.request);

            if (xhr.readyState == XMLHttpRequest.DONE) {
                console.log ("XHR:" + xhr.responseText);
                var jsonResponse = JSON.parse(xhr.responseText);

                if (jsonResponse.httpCode == 500)
                    document.getElementById('scheduleMeetingErrorMessage').innerText = "Error Making Meeting";
                else if (jsonResponse.httpCode == 200) {
                    document.getElementById('scheduleMeetingErrorMessage').innerText = "Meeting Scheduled";
                    document.getElementById('timeslotKeyField').value = '';
                    document.getElementById('nameTimeslot').value = '';
                    document.getElementById('meetingSecretKeyField').value = jsonResponse.secretCode;
                    document.getElementById('confirmMeetingForm').style.display = 'block';
                }
                else
                    alert(jsonResponse.message);

            }
        };
    }

    function deleteMeeting(){
        var meetingID = document.getElementById('timeslotKeyField2').value;
        var secretCode = document.getElementById('meetingSecretKey').value;

        var deleteMeetingData = {
            'meetingID': meetingID,
            'secretCode': secretCode
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", deleteMeetingsURL, true);

        var stringified = JSON.stringify(deleteMeetingData);

        xhr.send(stringified);
        xhr.onloadend = function () {
            console.log(xhr);
            console.log(xhr.request);

            if (xhr.readyState == XMLHttpRequest.DONE) {
                console.log ("XHR:" + xhr.responseText);
                var jsonResponse = JSON.parse(xhr.responseText);

                if (jsonResponse.httpCode == 500)
                    document.getElementById('scheduleMeetingErrorMessage').innerText = "Error Making Meeting";
                else if (jsonResponse.httpCode == 200) {
                    document.getElementById('cancelScheduleMeetingErrorMessage').innerText = "Meeting Canceled";
                    document.getElementById('timeslotKeyField2').value = '';
                    handleGetClick();
                    //document.getElementById('nameTimeslot').value = '';
                }
                else
                    alert(jsonResponse.message);

            }
        };
    }

    function organizerCancelMeeting(){
        var meetingID = document.getElementById('organizerCancelMeetingID').value;
        var secretCode = document.getElementById('cancelMeetingSecretKey').value;

        var organizerDeleteMeetingData = {
            'meetingID': meetingID,
            'orginizerSecretCode': secretCode
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", deleteMeetingOrganizerURL, true);

        var stringified = JSON.stringify(organizerDeleteMeetingData);

        xhr.send(stringified);
        xhr.onloadend = function () {
            console.log(xhr);
            console.log(xhr.request);

            if (xhr.readyState == XMLHttpRequest.DONE) {
                console.log ("XHR:" + xhr.responseText);
                var jsonResponse = JSON.parse(xhr.responseText);

                if (jsonResponse.httpCode == 500)
                    document.getElementById('scheduleMeetingErrorMessage').innerText = "Error canceling meeting by organizer";
                else if (jsonResponse.httpCode == 200) {
                    document.getElementById('organizerDeleteReload').style.display = "block";
                    document.getElementById('organizerDeleteErrorMessage').innerText = "Meeting Canceled by Organizer";

                }
                else
                    alert(jsonResponse.message);

            }
        };
    }

    function chooseOpenClose(){
        alert(document.getElementById('closeOpenH3').innerText);
        if(document.getElementById('closeOpenH3').innerText == 'Close Timeslot'){
            organizerCloseMeeting()
        }else {
            alert('here');
            organizerOpenMeeting()
        }
    }

    function organizerCloseMeeting(){
        var timeSlotID = document.getElementById('organizerCloseMeetingID').value;
        var secretCode = document.getElementById('closeMeetingSecretKey').value;

        var organizerDeleteMeetingData = {
            'timeSlotID': timeSlotID,
            'originizerSecretCode': secretCode
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", closeMeetingOrganizerURL, true);

        var stringified = JSON.stringify(organizerDeleteMeetingData);

        xhr.send(stringified);
        xhr.onloadend = function () {
            console.log(xhr);
            console.log(xhr.request);

            if (xhr.readyState == XMLHttpRequest.DONE) {
                console.log ("XHR:" + xhr.responseText);
                var jsonResponse = JSON.parse(xhr.responseText);

                if (jsonResponse.httpCode == 500)
                    document.getElementById('organizerCloseErrorMessage').innerText = "Error closing timeslot by organizer";
                else if (jsonResponse.httpCode == 200) {
                    document.getElementById('organizerCloseReload').style.display = "block";
                    document.getElementById('organizerCloseErrorMessage').innerText = "Timeslot Successfully Closed by Organizer";

                }
                else
                    alert(jsonResponse.message);

            }
        };
    }

    function organizerOpenMeeting(){
        var timeSlotID = document.getElementById('organizerCloseMeetingID').value;
        var secretCode = document.getElementById('closeMeetingSecretKey').value;

        var organizerDeleteMeetingData = {
            'timeSlotID': timeSlotID,
            'originizerSecretCode': secretCode
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", openMeetingOrganizerURL, true);

        var stringified = JSON.stringify(organizerDeleteMeetingData);

        xhr.send(stringified);
        xhr.onloadend = function () {
            console.log(xhr);
            console.log(xhr.request);

            if (xhr.readyState == XMLHttpRequest.DONE) {
                console.log ("XHR:" + xhr.responseText);
                var jsonResponse = JSON.parse(xhr.responseText);

                if (jsonResponse.httpCode == 500)
                    document.getElementById('organizerCloseErrorMessage').innerText = "Error opening timeslot by organizer";
                else if (jsonResponse.httpCode == 200) {
                    document.getElementById('organizerCloseReload').style.display = "block";
                    document.getElementById('organizerCloseErrorMessage').innerText = "Timeslot Successfully Opened by Organizer";

                }
                else
                    alert(jsonResponse.message);

            }
        };
    }

    function hideDivs(){
        document.getElementById('meetingDiv').style.display = 'none';
        document.getElementById('confirmMeetingForm').style.display = 'none';
        document.getElementById("cancelMeetingDiv").style.display = "none";
        document.getElementById("organizerDeleteReload").style.display = "none";
        document.getElementById("cancelScheduleMeetingErrorMessage").value = "";
        document.getElementById("organizerCloseReload").style.display = "none";
        document.getElementById("cancelScheduleMeetingErrorMessage").value = "";
        document.getElementById("cancelMeetingSecretKey").value = "";
        document.getElementById("closeMeetingSecretKey").value = "";
        document.getElementById("organizerDeleteErrorMessage").innerText = "";
        document.getElementById("confirmCancelMeetingForm").value = "";
        document.getElementById("meetingSecretKey").value = "";
        document.getElementById("organizerCloseMeetingID").value = "";
        document.getElementById("organizerCloseErrorMessage").innerText = "";
        document.getElementById('closeOpenH3').innerText = 'Close/Open TimeSlot'

    }



    function noScheduleFound(){
        document.getElementById("scheduleForm").style.visibility = "visible";
        document.getElementById("createScheduleDiv").style.visibility = "visible";
        document.getElementById('errMessage').innerText = 'No Schedule with an id of ' + document.getElementById("scheduleID").value + ' found. Try again or create your own.';
        document.getElementById("scheduleID").value = '';
    }





    function deleteSchedule(){
        var secretKey = document.getElementById('secretKey').value;
        var scheduleID = document.getElementById('scheduleIDDelete').value;

        var deleteScheduleData = {
            'scheduleID': scheduleID,
            'originizerSecretCode': secretKey
        };

        var xhr = new XMLHttpRequest();
        xhr.open("POST", deleteURL, true);

        var stringified = JSON.stringify(deleteScheduleData);

        xhr.send(stringified);
        xhr.onloadend = function () {
            console.log(xhr);
            console.log(xhr.request);

            if (xhr.readyState == XMLHttpRequest.DONE) {
                console.log ("XHR:" + xhr.responseText);
                var jsonResponse = JSON.parse(xhr.responseText);

                if (jsonResponse.httpCode == 500)
                    document.getElementById('deleteErrorMessage').innerText = "Values do not match up.";
                else if (jsonResponse.httpCode == 200) {
                    alert('200');
                    document.getElementById('deleteErrorMessage').innerText = "Delete Successful. Refreshing in 3 seconds";
                    setTimeout(function () {
                        window.location.reload();
                    }, 3000);
                }
                else
                    alert(jsonResponse.message);

            }
        };
    }

    function toggleOrganizerDiv(){
        var meetingButtons = document.getElementsByClassName('meetingButton');
        if (document.getElementById("organizerDiv").style.display == "none") {
            document.getElementById("organizerDiv").style.display = "block";
            for (var x = 0; x < meetingButtons.length; x++) {
                if (meetingButtons[x].innerText == 'CLOSED')
                    meetingButtons[x].disabled = false;
            }
            hideDivs();
        }else {
            document.getElementById("organizerDiv").style.display = "none";
            for (var x = 0; x < meetingButtons.length; x++) {
                if (meetingButtons[x].innerText == 'CLOSED')
                    meetingButtons[x].disabled = true;
            }
        }
    }


</script>

</body>
</html>